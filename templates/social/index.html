<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Godavari-Krishna Social Links</title>
  <link rel="icon" type="image/png" href="static/social/gk.png"/>
  <link rel="stylesheet" href="/social-links/styles.css"/>
</head>
<body>

  <section class="page">
    <!-- HEADER -->
    <header class="header">
      <div class="logo">
        <img src="/social-links/gk.png" alt="GK Logo">
      </div>

      <div class="header-text">
        <h1>Godavari~Krishna Co-Operative Society Ltd.,</h1>
        <h3>Social Media Accounts</h3>
        <p>Discover and connect across platforms</p>
      </div>
    </header>

    <!-- CARDS -->
    <div class="cards">
      <a class="card" href="https://www.facebook.com/share/1CGWvx8Zwo/" target="_blank" rel="noopener noreferrer" data-platform="facebook">
        <div class="icon facebook">
          <img src="/social-links/facebook.png" alt="Facebook">
        </div>
        <h2>Facebook</h2>
        <p>Connect with friends and family</p>
      </a>

      <a class="card" href="https://www.instagram.com/godavarikrishnasociety?igsh=NDA0cDdnejU1YWM2" target="_blank" rel="noopener noreferrer" data-platform="instagram">
        <div class="icon instagram">
          <img src="/social-links/instagram.png" alt="Instagram">
        </div>
        <h2>Instagram</h2>
        <p>Share photos and stories</p>
      </a>

      <a class="card" href="https://youtube.com/@godavarikrishnaco-opsociet6591?si=lAsb2CVDz64m_fbc" target="_blank" rel="noopener noreferrer" data-platform="youtube">
        <div class="icon youtube">
          <img src="/social-links/youtube.png" alt="YouTube">
        </div>
        <h2>YouTube</h2>
        <p>Watch and create videos</p>
      </a>

      <a class="card" href="https://www.threads.com/@godavarikrishnasociety" target="_blank" rel="noopener noreferrer" data-platform="threads">
        <div class="icon threads">
          <img src="/social-links/threads.png" alt="Threads">
        </div>
        <h2>Threads</h2>
      </a>

      <a class="card" href="https://x.com/GodavariCo" target="_blank" rel="noopener noreferrer" data-platform="twitter">
        <div class="icon twitter">
          <img src="/social-links/twitter.png" alt="Twitter">
        </div>
        <h2>Twitter</h2>
      </a>

      <a class="card" href="https://whatsapp.com/channel/0029Vb70MKi8F2pCSvo2u80S" target="_blank" rel="noopener noreferrer" data-platform="whatsapp">
        <div class="icon whatsapp">
          <img src="/social-links/whatsapp.png" alt="WhatsApp">
        </div>
        <h2>WhatsApp</h2>
      </a>
    </div>
    
    <footer class="footer">
      &copy; 2024 Godavari Krishna Co-operative Society Limited - All Rights Reserved.
    </footer>
  </section>

  <script>
    // Track social media clicks with branch tracking
    const API = 'https://qr-code-2-0-22ky.onrender.com';
    
    // Get branch code from URL parameter (set by QR code redirect)
    const urlParams = new URLSearchParams(window.location.search);
    const branchCode = urlParams.get('branch');
    
    // Generate session ID for new vs returning tracking
    function generateSessionId() {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      ctx.textBaseline = 'top';
      ctx.font = '14px Arial';
      ctx.fillText('fingerprint', 2, 2);
      const fingerprint = canvas.toDataURL();
      
      const data = navigator.userAgent + fingerprint + screen.width + screen.height;
      let hash = 0;
      for (let i = 0; i < data.length; i++) {
        const char = data.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }
      return Math.abs(hash).toString(16);
    }
    
    const sessionId = generateSessionId();
    
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('click', async (e) => {
        const platform = card.getAttribute('data-platform');
        
        // Send tracking data (non-blocking)
        try {
          await fetch(`${API}/api/social-click`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 
              platform,
              branch_code: branchCode,
              session_id: sessionId
            })
          });
        } catch (err) {
          console.log('Tracking failed:', err);
        }
        
        // Don't prevent default - let the link open
      });
    });
  </script>

</body>
</html>